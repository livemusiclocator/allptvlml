(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[417],{9169:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/gtfs",function(){return t(3080)}])},2441:function(e,s,t){"use strict";t.d(s,{Z:function(){return Layout}});var a=t(5893),r=t(7294),i=t(1664),l=t.n(i),n=t(1163);function Header(){let[e,s]=(0,r.useState)(!1),t=(0,n.useRouter)(),toggleMenu=()=>{s(!e)},isActive=e=>t.pathname===e?"text-ptv-blue font-semibold":"text-gray-700 hover:text-ptv-blue";return(0,a.jsx)("header",{className:"bg-white shadow-sm",children:(0,a.jsxs)("div",{className:"container mx-auto px-4 py-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)(l(),{href:"/",className:"flex items-center space-x-2",children:(0,a.jsx)("span",{className:"text-xl font-bold text-ptv-blue",children:"PTV-LML"})}),(0,a.jsx)("button",{className:"md:hidden p-2 rounded-md text-gray-700 hover:bg-gray-100 focus:outline-none",onClick:toggleMenu,"aria-label":"Toggle menu",children:(0,a.jsx)("svg",{className:"h-6 w-6",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e?(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"}):(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),(0,a.jsxs)("nav",{className:"hidden md:flex space-x-8",children:[(0,a.jsx)(l(),{href:"/",className:"".concat(isActive("/")," transition-colors"),children:"Home"}),(0,a.jsx)(l(),{href:"/routes",className:"".concat(isActive("/routes")," transition-colors"),children:"Routes"}),(0,a.jsx)(l(),{href:"/allgigs",className:"".concat(isActive("/allgigs")," transition-colors"),children:"Live Music"}),(0,a.jsx)(l(),{href:"/about",className:"".concat(isActive("/about")," transition-colors"),children:"About"})]})]}),e&&(0,a.jsx)("nav",{className:"md:hidden mt-4 pt-4 border-t border-gray-200",children:(0,a.jsxs)("ul",{className:"space-y-4",children:[(0,a.jsx)("li",{children:(0,a.jsx)(l(),{href:"/",className:"".concat(isActive("/")," block py-2"),onClick:toggleMenu,children:"Home"})}),(0,a.jsx)("li",{children:(0,a.jsx)(l(),{href:"/routes",className:"".concat(isActive("/routes")," block py-2"),onClick:toggleMenu,children:"Routes"})}),(0,a.jsx)("li",{children:(0,a.jsx)(l(),{href:"/allgigs",className:"".concat(isActive("/allgigs")," block py-2"),onClick:toggleMenu,children:"Live Music"})}),(0,a.jsx)("li",{children:(0,a.jsx)(l(),{href:"/about",className:"".concat(isActive("/about")," block py-2"),onClick:toggleMenu,children:"About"})})]})})]})})}var c=t(5675),o=t.n(c);function Footer(){let e=new Date().getFullYear();return(0,a.jsx)("footer",{className:"bg-gray-800 text-white py-8",children:(0,a.jsxs)("div",{className:"container mx-auto px-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center mb-4",children:[(0,a.jsx)(o(),{src:"/images/LML_1_RGB.png",alt:"Live Music Locator Logo",width:80,height:80,className:"mr-3"}),(0,a.jsx)("h3",{className:"text-lg font-semibold",children:"PTV-LML"})]}),(0,a.jsx)("p",{className:"text-gray-300 text-sm",children:"A web application that displays Public Transport Victoria route information (including SkyBus) and integrates with live music gig data."}),(0,a.jsx)("p",{className:"text-gray-300 text-sm mt-2",children:(0,a.jsx)("a",{href:"http://lml.live",target:"_blank",rel:"noopener noreferrer",className:"text-blue-400 hover:text-blue-300 transition-colors",children:"Powered by Live Music Locator technology"})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Quick Links"}),(0,a.jsxs)("ul",{className:"space-y-2 text-gray-300 text-sm",children:[(0,a.jsx)("li",{children:(0,a.jsx)(l(),{href:"/",className:"hover:text-white transition-colors",children:"Home"})}),(0,a.jsx)("li",{children:(0,a.jsx)(l(),{href:"/routes",className:"hover:text-white transition-colors",children:"Routes"})}),(0,a.jsx)("li",{children:(0,a.jsx)(l(),{href:"/allgigs",className:"hover:text-white transition-colors",children:"Live Music"})}),(0,a.jsx)("li",{children:(0,a.jsx)(l(),{href:"/about",className:"hover:text-white transition-colors",children:"About"})})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"External Resources"}),(0,a.jsxs)("ul",{className:"space-y-2 text-gray-300 text-sm",children:[(0,a.jsx)("li",{children:(0,a.jsx)("a",{href:"https://www.ptv.vic.gov.au/",target:"_blank",rel:"noopener noreferrer",className:"hover:text-white transition-colors",children:"PTV Official Website"})}),(0,a.jsx)("li",{children:(0,a.jsx)("a",{href:"https://www.ptv.vic.gov.au/footer/data-and-reporting/datasets/ptv-timetable-api/",target:"_blank",rel:"noopener noreferrer",className:"hover:text-white transition-colors",children:"PTV API Documentation"})}),(0,a.jsx)("li",{children:(0,a.jsx)("a",{href:"http://lml.live",target:"_blank",rel:"noopener noreferrer",className:"hover:text-white transition-colors",children:"Live Music Locator"})}),(0,a.jsx)("li",{children:(0,a.jsx)("a",{href:"https://github.com/yourusername/ptv-lml",target:"_blank",rel:"noopener noreferrer",className:"hover:text-white transition-colors",children:"GitHub Repository"})})]})]})]}),(0,a.jsxs)("div",{className:"border-t border-gray-700 mt-8 pt-6 text-center text-sm text-gray-400",children:[(0,a.jsxs)("p",{children:["\xa9 ",e," PTV-LML. All rights reserved."]}),(0,a.jsxs)("p",{className:"mt-2",children:["PTV data is used under ",(0,a.jsx)("a",{href:"https://www.ptv.vic.gov.au/footer/data-and-reporting/datasets/",target:"_blank",rel:"noopener noreferrer",className:"text-blue-400 hover:text-blue-300",children:"Creative Commons Attribution 4.0 International license"}),"."]}),(0,a.jsx)("p",{className:"mt-2",children:"This is an unofficial application and is not affiliated with Public Transport Victoria."}),(0,a.jsxs)("p",{className:"mt-2",children:["Live Music Locator technology used with permission. Visit ",(0,a.jsx)("a",{href:"http://lml.live",target:"_blank",rel:"noopener noreferrer",className:"text-blue-400 hover:text-blue-300",children:"lml.live"})," for more information."]})]})]})})}function Layout(e){let{children:s}=e;return(0,a.jsxs)("div",{className:"flex flex-col min-h-screen",children:[(0,a.jsx)(Header,{}),(0,a.jsx)("main",{className:"flex-grow",children:s}),(0,a.jsx)(Footer,{})]})}},3080:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return GTFSAdmin}});var a=t(5893),r=t(7294),i=t(2441),l=t(9008),n=t.n(l),c=t(1664),o=t.n(c);function GTFSAdmin(){let[e,s]=(0,r.useState)(null),[t,l]=(0,r.useState)(!0),[c,d]=(0,r.useState)(!1),[h,m]=(0,r.useState)("");(0,r.useEffect)(()=>{fetchStatus()},[]);let fetchStatus=async()=>{try{l(!0);let e=await fetch("/api/gtfs/status");if(e.ok){let t=await e.json();s(t),m("")}else{let t=await e.json();m("Error: ".concat(t.error||t.message||"Unknown error")),s(null)}}catch(e){m("Error fetching GTFS status: ".concat(e instanceof Error?e.message:"Unknown error")),s(null)}finally{l(!1)}},triggerUpdate=async()=>{try{d(!0),m("Updating GTFS data... This may take a few minutes.");let e=await fetch("/api/gtfs/update",{method:"POST"}),s=await e.json();e.ok?(m("GTFS data update initiated. Check logs for details."),setTimeout(()=>{fetchStatus()},5e3)):m("Error updating GTFS data: ".concat(s.error||"Unknown error"))}catch(e){m("Error updating GTFS data: ".concat(e instanceof Error?e.message:"Unknown error"))}finally{d(!1)}},formatFileSize=e=>e<1024?"".concat(e," B"):e<1048576?"".concat((e/1024).toFixed(2)," KB"):"".concat((e/1048576).toFixed(2)," MB");return(0,a.jsxs)(i.Z,{children:[(0,a.jsx)(n(),{children:(0,a.jsx)("title",{children:"PTV-LML | GTFS Admin"})}),(0,a.jsxs)("div",{className:"container py-8",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold",children:"GTFS Data Management"}),(0,a.jsx)(o(),{href:"/",className:"text-ptv-blue hover:underline",children:"Back to Home"})]}),t?(0,a.jsx)("div",{className:"flex justify-center items-center py-12",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-ptv-blue"})}):(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"GTFS Status"}),e?(0,a.jsxs)("div",{className:"bg-gray-100 p-4 rounded-md",children:[(0,a.jsxs)("p",{className:"mb-2",children:[(0,a.jsx)("span",{className:"font-semibold",children:"Last Updated:"})," ",new Date(e.lastUpdated).toLocaleString()]}),(0,a.jsxs)("p",{className:"mb-2",children:[(0,a.jsx)("span",{className:"font-semibold",children:"Days Since Update:"})," ",e.daysSinceUpdate]}),(0,a.jsxs)("p",{className:"mb-4",children:[(0,a.jsx)("span",{className:"font-semibold",children:"Status:"})," ",(0,a.jsx)("span",{className:"current"===e.status?"text-green-600":"text-red-600",children:e.status})]}),(0,a.jsx)("h3",{className:"text-lg font-semibold mt-4 mb-2",children:"Sources"}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:e.sources.map(e=>(0,a.jsxs)("div",{className:"bg-white p-4 rounded-md shadow-sm",children:[(0,a.jsx)("p",{className:"font-semibold text-lg",children:e.name}),(0,a.jsxs)("p",{className:"text-gray-600 mb-2",children:["Route Type: ",e.routeType]}),(0,a.jsxs)("p",{className:"mb-1",children:[(0,a.jsx)("span",{className:"font-medium",children:"Version:"})," ",e.version]}),(0,a.jsxs)("p",{className:"mb-1",children:[(0,a.jsx)("span",{className:"font-medium",children:"File Size:"})," ",formatFileSize(e.fileSize)]}),(0,a.jsxs)("p",{className:"mb-1",children:[(0,a.jsx)("span",{className:"font-medium",children:"File Exists:"})," ",(0,a.jsx)("span",{className:e.fileExists?"text-green-600":"text-red-600",children:e.fileExists?"Yes":"No"})]}),(0,a.jsxs)("p",{className:"text-xs text-gray-500 truncate",title:e.fileHash,children:[(0,a.jsx)("span",{className:"font-medium",children:"Hash:"})," ",e.fileHash.substring(0,16),"..."]})]},e.name))})]}):(0,a.jsx)("div",{className:"bg-yellow-100 border border-yellow-400 text-yellow-700 px-4 py-3 rounded relative",children:(0,a.jsx)("p",{children:"No GTFS status information available. You may need to run the update script for the first time."})})]}),(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"Manual Update"}),(0,a.jsx)("p",{className:"mb-4 text-gray-600",children:"Click the button below to manually update GTFS data. This process may take a few minutes."}),(0,a.jsx)("button",{className:"bg-ptv-blue text-white px-4 py-2 rounded-md hover:bg-blue-700 disabled:bg-gray-400",onClick:triggerUpdate,disabled:c,children:c?"Updating...":"Update GTFS Data Now"}),h&&(0,a.jsx)("div",{className:"mt-4 p-3 rounded-md ".concat(h.includes("Error")?"bg-red-100 text-red-700":"bg-blue-100 text-blue-700"),children:h})]}),(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"Documentation"}),(0,a.jsxs)("p",{className:"mb-2",children:["For more information on GTFS data updates, please refer to the"," ",(0,a.jsx)(o(),{href:"/docs/gtfs-update-guide.md",className:"text-ptv-blue hover:underline",target:"_blank",children:"GTFS Update Guide"}),"."]})]})]})]})]})}}},function(e){e.O(0,[664,675,774,888,179],function(){return e(e.s=9169)}),_N_E=e.O()}]);